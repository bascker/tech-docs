# vmstat
## 简介

* vmstat 是 virtual memory statics 的简称，即虚拟内存统计
* 可以显示进程、内存、IO等系统整体运行状态
* 语法：vmstat \[option\] \[delay \[count\]\]
* 选项
  * -a：显示活动内页
  * -f：显示启动后创建的进程总数
  * -d：显示磁盘状态
  * -p：显示磁盘分区状态
* 参数
  * delay：状态信息刷新时间间隔
  * count：统计次数

## 案例
每 3s 刷新一次信息，统计 5 次

```
$ vmstat 3 5
procs -----------memory---------- ---swap-- -----io---- -system-- ------cpu-----
 r  b   swpd   free   buff  cache     si   so    bi    bo   in     cs us sy id wa st
 3  1 1972856 415972      0 1650944    0    0     1    26    0      0 12  4 84  1  0
 0  0 1972856 414112      0 1653104    0    0     1   241 29796 52646 20  9 70  1  0
 1  0 1972856 415988      0 1650884    0    0     0    88  9216 16382  7  2 90  1  0
 4  0 1972856 414772      0 1653304    0    0     1   355 21276 37715 14  6 79  1  0
 0  0 1972856 415360      0 1650928    0    0     5   231 13783 23748 12  4 82  2  0
```

从中可以看到 in \(中断数\)和 cs \(上下文切换\)值很大，可知 CPU 不断在请求资源

**输出解释**：

1.**procs**：进程

* **r**：run queue，可运行队列中的进程数，可用于判断是否需要增加 CPU
* **b**：被阻塞\(blocked\)的进程数。即等待IO的进程数

2.**memory**：内存

* **swpd**：可使用内存大小
* **free**：空闲内存大小
* **buff**：用作缓冲的内存大小
* **cache**：用作缓存的内存大小

3.**swap**：交换分区

* si：每秒从交换区**写入**内存的大小，**从磁盘调入内存**
* so：每秒从内存**读入**交换区的大小，**从内存调入磁盘**

> 内存够用的时候，这2个值都是0，如果这2个值长期大于0时，系统性能会受到影响，磁盘IO和CPU资源都会被消耗

4.**IO**

* **bi**：每秒读取的块数
* **bo**：每秒写入的块数

5.**system**

* **in**：interrupts，每秒中断数
* **cs**：context switch，每秒上下文切换数

6.**cpu**

* **us**：用户进程执行时间百分比
* **sy**：内核系统进程执行时间百分比
* **wa**：IO等待时间百分比
* **id**：空闲时间百分比